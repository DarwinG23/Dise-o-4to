{% extends 'estudiante/estudianteInicio.html' %}
{% block content %}
<script src="https://kit.fontawesome.com/a076d05399.js"></script>
<script>
    $(document).ready(function(){
        $("#link").click(function(){
            create();
        });

        $("#valor").on("input", function(){
            // Obtener el valor del campo de texto
            var valor = $(this).val();

            // Si el campo está vacío
            if (valor === "") {
                create();
            } else {
                console.log("El campo tiene texto: ", valor);
                buscar();  // Llamar a la función de búsqueda si el campo tiene texto
            }
        });
    });

    function tabla(url){
        $.ajax({
            method: "GET",
            url: url,
            contentType: 'json',
            success: function(data){
                console.log(url);
                if(data.code == '200'){
                    var html = '';
                    $.each(data.data, function(i, info){
                        html+="<tr>";
                        html+= "<td>"+info.id+"</td>";
                        html+= "<td>"+info.nombre+"</td>";
                        html+= "<td>"+info.apellido+"</td>";
                        html+= "<td>"+info.titulo+"</td>";
                        html+= "<td>"+'<a href="/servidores/editar/'+info.id+'" class="btn btn-info text-white"><i class="fas fa-edit"></i> Editar</a>'+"</td>";
                        html+= "<td>"+'<a href="/servidores/eliminar/'+info.id+'" class="btn btn-danger"><i class="fas fa-trash-alt"></i> Eliminar</a>'+"</td>";
                        html+="</tr>";
                    });
                    $("#tabla tbody").html(html);
                }else{
                    html += "<tr><td colspan='7'>No se encontraron datos</td></tr>";
                    $("#tabla tbody").html(html);
                }
            }
        });
    }

    function create(){
        var aux = $("#tipo").prop("checked");
        var select = $("#criterio").find(":selected").val();
        var metodo = $("#metodo").find(":selected").val();
        if(aux){
            tabla("http://localhost:5000/docentes/ordenar/2/"+select+"/"+3);
        }else{
            tabla("http://localhost:5000/docentes/ordenar/1/"+select+"/"+3);
        }
    }

    function buscar(){
        var atributo = $("#criterio").find(":selected").val();
        var valor = $("#valor").val();
        tabla("http://localhost:5000/docentes/busqueda/1/"+valor+"/"+atributo);
    }
</script>
<div class="text-center">
    <h2 class="display-5 text-white p-4" style="background-color: #343a40; border-radius: 8px;">Gestionar Cuentas</h2>
</div>
<div class="row mt-4">
    <div class="card p-4 shadow-lg">
        <!-- Sección de Ordenar -->
        <div class="row mb-4 align-items-center">
            <div class="col-md-4 d-flex align-items-center">
                <label for="criterio" class="me-2">Criterio:</label>
                <select id="criterio" class="form-select w-auto">
                    <option value="_nombre">Nombre</option>
                    <option value="_apellido">Apellido</option>
                    <option value="_titulo">Título</option>
                </select>
            </div>
            <div class="col-md-4 d-flex align-items-center">
                <input type="checkbox" value="DESCENDENTE" id="tipo" class="form-check-input me-2">
                <label for="tipo" class="form-check-label">DESCENDENTE</label>
            </div>
            <div class="col-md-4 text-end">
                <button class="btn btn-info w-100" id="link"><i class="fas fa-sort"></i> Ordenar</button>
            </div>
        </div>

        <!-- Sección de Buscar -->
        <div class="row mb-4 align-items-center">
            <div class="col-md-8">
                <input type="text" id="valor" class="form-control" placeholder="Ingrese el valor a buscar">
            </div>
            <div class="col-md-4 text-end">
                <button class="btn btn-info w-100" id="buscar"><i class="fas fa-search"></i> Buscar</button>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <table id="tabla" class="table text-black table-striped table-hover table-bordered">
        <thead class="thead-dark">
            <tr>
                <th><i class="fas fa-hashtag"></i> Nro</th>
                <th><i class="fas fa-user"></i> Nombre</th>
                <th><i class="fas fa-user-tag"></i> Apellido</th>
                <th><i class="fas fa-graduation-cap"></i> Título</th>
                <th colspan="2"><i class="fas fa-cogs"></i> Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for item in lista %}
                <tr>
                    <td>{{item.id}}</td>
                    <td>{{item.nombre}}</td>
                    <td>{{item.apellido}}</td>
                    <td>{{item.titulo}}</td>
                    <td><a href="/administrador/modificarDocente/ver/{{roles}}/{{nombreU}}/{{apellidoU}}/{{item.id}}" class="btn btn-info text-white"><i class="fas fa-edit"></i> Editar</a></td>
                    <td><a href="/servidores/eliminar/{{item.id}}" class="btn btn-danger"><i class="fas fa-trash-alt"></i> Eliminar</a></td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f8f9fa;
        margin: 0;
        padding: 0;
    }

    .text-center {
        margin-top: 20px;
    }

    .display-5 {
        font-size: 2.5rem;
        font-weight: 300;
    }

    .table {
        margin-top: 20px;
        width: 100%;
    }

    .card {
        background-color: #ffffff;
        border: 1px solid #dee2e6;
        border-radius: 0.25rem;
        box-shadow: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.1);
    }

    .form-select,
    .form-control {
        margin-bottom: 10px;
    }

    .btn-info {
        background-color: #17a2b8;
        border-color: #17a2b8;
    }

    .btn-info:hover {
        background-color: #138496;
        border-color: #117a8b;
    }

    .btn-danger {
        background-color: #dc3545;
        border-color: #dc3545;
    }

    .btn-danger:hover {
        background-color: #c82333;
        border-color: #bd2130;
    }

    .table th,
    .table td {
        vertical-align: middle;
        text-align: center;
    }

    .table th {
        background-color: #343a40;
        color: #ffffff;
    }

    .table-striped tbody tr:nth-of-type(odd) {
        background-color: rgba(0, 0, 0, 0.05);
    }

    .btn i {
        margin-right: 8px;
    }
</style>
{% endblock %}
